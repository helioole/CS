import random

def diffie_hellman(p, g):
    a = random.randint(1, p - 1)

    b = random.randint(1, p - 1)

    A = pow(g, a, p)

    B = pow(g, b, p)

    secret_key_Alice = pow(B, a, p)
    secret_key_Bob = pow(A, b, p)

    print("Alice Private Key:", a)
    print("Bob Private Key:", b)
    print("\nAlice Public Key:", A)
    print("Bob Public Key:", B)

    assert secret_key_Alice == secret_key_Bob

    return secret_key_Alice

p = 323170060713110073001535134778251633624880571334890751745884341392698068341362100027920563626401646854585563579353308169288829023080573472625273554742461245741026202527916572972862706300325263428213145766931414223654220941111348629991657478268034230553086349050635557712219187890332729569696961297438562417412362372251973464026918557977679768023014625397933058015226858730761197532436467475855460715043896844940366130495768128542959588576514223145766931414223654220941111348629991657478268034230553086349050635557712219187890332729569696961297438562490632338072839127039
g = 2

shared_secret_key = diffie_hellman(p, g)

print("\nShared Secret Key:", shared_secret_key)
